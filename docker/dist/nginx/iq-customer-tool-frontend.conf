server {
    # rules for a static/frontend comp
    include rules/listen.conf;
    
    add_header NGX-Cache $upstream_cache_status;
    server_name ${DNS};
    fastcgi_cache ${CACHE};
    fastcgi_cache_valid 200 60m;
    
    root ${DEPLOY}/public;
    set $container ${CONTAINER};

    location / {
        try_files $uri @rewriteapp;
    }

    location @rewriteapp {
        rewrite  ^/(\?.*)?$  /index.html$1  last;
    }
}